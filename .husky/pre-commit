#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running code checks and validations..."

echo "ğŸ§¹ Running lint-staged (ESLint and Prettier)..."
npx lint-staged || {
  echo "âŒ There were linting or formatting errors. Please fix them and try again."
  exit 1
}

echo "ğŸ§ª Running validation scripts..."
npm run validate-queries || {
  echo "âŒ Query validation failed. Please fix the errors and try again."
  exit 1
}

npm run validate-pagination || {
  echo "âŒ Pagination validation failed. Please fix the errors and try again."
  exit 1
}

npm run validate-pagination-usage || {
  echo "âŒ Pagination usage validation failed. Please fix the errors and try again."
  exit 1
}

npm run check-imports || {
  echo "âŒ Import check failed. Please fix the errors and try again."
  exit 1
}

echo "ğŸ—ï¸ Attempting to build the project..."
npm run build || {
  echo "âŒ Build failed. Please fix the errors and try again."
  exit 1
}

echo "âœ… All checks passed! Committing changes..."