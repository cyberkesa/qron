# Стандарты кодирования для проекта Qron

## Форматирование кода

Проект Qron использует [Prettier](https://prettier.io/) для форматирования кода и [ESLint](https://eslint.org/) для статического анализа кода. Важно поддерживать единое форматирование для улучшения читаемости кода и упрощения совместной работы.

### Основные правила форматирования:

- Используйте **двойные кавычки** для строк
- Используйте **запятые** в конце объектов и массивов
- Максимальная длина строки: **80 символов**
- Отступы: **2 пробела**
- В конце файла должна быть пустая строка
- Между операторами должны быть пробелы

## Работа с ESLint и Prettier

### Автоматическое форматирование

Проект настроен так, чтобы автоматически форматировать код при сохранении (если используется VSCode с установленными расширениями) и перед коммитом:

```bash
# Форматировать весь проект вручную
npm run format

# Только проверить форматирование без изменения файлов
npm run format:check

# Запустить ESLint с автоматическим исправлением
npm run lint:fix

# Исправить форматирование и ошибки ESLint сразу
npm run fix-all
```

## Специфические правила React

1. **Хуки React должны вызываться в одном и том же порядке при каждом рендере:**

   - Никогда не вызывайте хуки из условных выражений или циклов
   - Никогда не вызывайте хуки после раннего возврата из компонента
   - Всегда объявляйте все хуки в начале компонента

   ```jsx
   // ❌ Неправильно
   if (condition) {
     useEffect(() => {
       // ...
     }, []);
   }

   // ✅ Правильно
   useEffect(() => {
     if (!condition) return;
     // ...
   }, [condition]);
   ```

2. **Массивы зависимостей должны включать все изменяемые значения:**

   - Используйте инструмент анализа зависимостей: `npm run analyze-effects`
   - ESLint будет предупреждать о пропущенных зависимостях
   - Если нужно исключить зависимость, объясните причину в комментарии

3. **Используйте функциональные компоненты и хуки** вместо классовых компонентов

4. **Используйте TypeScript** для всех компонентов и интерфейсов

## Правила оптимизации

1. **Используйте мемоизацию при работе с тяжелыми вычислениями:**

   - `useMemo` для мемоизации вычислений
   - `useCallback` для стабильных ссылок на функции
   - `memo` для предотвращения лишних рендеров компонентов

2. **Для загрузки изображений используйте компоненты оптимизации:**

   - `OptimizedImage` вместо прямого использования `<img>`
   - `LazyImage` для ленивой загрузки изображений

3. **Оптимизируйте API-запросы:**
   - Используйте `useOptimizedQuery` вместо стандартного `useQuery`
   - Настраивайте правильное кеширование для запросов

## Инструменты отладки производительности

В проекте есть встроенные инструменты отладки производительности:

- `PerformanceDashboard` - для мониторинга Core Web Vitals
- `NetworkMonitor` - для отслеживания медленных сетевых запросов
- `PerformanceMarker` - для измерения времени рендеринга компонентов

Используйте их в режиме разработки для выявления проблем с производительностью.

## Настройка VSCode

Рекомендуемые расширения VSCode:

- ESLint
- Prettier
- Todo Tree

В проекте уже настроен файл `.vscode/settings.json` для автоматического форматирования при сохранении.

## Pre-commit хуки

В проекте настроены pre-commit хуки с помощью husky, которые автоматически запускают форматирование и проверку линтера перед коммитом.

## Решение проблем

Если вы столкнулись с проблемами форматирования, попробуйте:

1. Запустить `npm run fix-all` для исправления всех проблем
2. Удалить файл `.next` и запустить сборку заново: `rm -rf .next && npm run build`
3. Проверить, что у вас установлены все зависимости: `npm install`
